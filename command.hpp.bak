#include <stdio.h>
#include <stdlib.h>
#include <string>
#include <cstring>
#include <sstream>
#include "job.hpp"

class Command : public Job{
	public:
	char * argv[];
	Command(const char * str){
		//cmd = std::string(str);
		//std::cout << "this is your string: " << cmd << std::endl;
		build_argv(str);
		
	}

	void build_argv(const char * str){
		int nb = calc_nb_elements(str);
		//std::cout << "nb elements:" << nb << std::endl;
		const char ** res = new const char*[nb+1];
		int res_index = 0;
		std::string * tmp = new std::string();
		for(;*str != 0; str++){
			//std::cout << *str;
			if(*str != ' ') *tmp+=*str;
			else{
				res[res_index] = tmp->c_str();
				res_index++;
				//std::cout << *tmp << std::endl;
				tmp = new std::string();	
			}
		}
		res[res_index] = tmp->c_str();
		//std::cout << tmp << std::endl;
		res_index++;
		
		res[res_index] = (char*) 0;
		//std::cout << std::endl << "res content:" << std::endl;
		for(int j=0; res[j] != 0; j++){
			std::cout<< res[j] << std::endl;
		}
	}

	int calc_nb_elements(const char * str){
		int i=0;
		for(; *str != 0; str++){
			if(*str==' ') i++;
		}		
		return i+1;
	}

	int run(){
		/*std::cout << "your command is: " << cmd << " with pid: " << getpid() << std::endl;
		char* args[] = {}
		execvp("ls", "ls", "-l", (char*) 0);
		*/
		exit(1);
	}
};
